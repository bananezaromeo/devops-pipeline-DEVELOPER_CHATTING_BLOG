const express = require('express');const router = express.Router();const authMiddleware = require('../middleware/authMiddleware');const Message = require('../models/Message');/** * @swagger * /api/messages: *   post: *     summary: Send a message to another user *     security: *       - bearerAuth: [] *     requestBody: *       required: true *       content: *         application/json: *           schema: *             type: object *             properties: *               receiverId: *                 type: string *               content: *                 type: string *     responses: *       200: *         description: Message sent *       401: *         description: Unauthorized */router.post('/messages', authMiddleware, async (req, res) => {  try {    const { receiverId, content } = req.body;    const message = await Message.create({      sender: req.user.id,      receiver: receiverId,      content, // frontend should encrypt before sending    });    res.status(200).json(message);  } catch (err) {    console.error(err);    res.status(500).json({ message: 'Server error' });  }});/** * @swagger * /api/messages/{userId}: *   get: *     summary: Get messages between current user and another user *     security: *       - bearerAuth: [] *     parameters: *       - name: userId *         in: path *         required: true *         schema: *           type: string *     responses: *       200: *         description: List of messages *       401: *         description: Unauthorized */router.get('/messages/:userId', authMiddleware, async (req, res) => {  try {    const { userId } = req.params;    const messages = await Message.find({      $or: [        { sender: req.user.id, receiver: userId },        { sender: userId, receiver: req.user.id }      ]    }).sort({ createdAt: 1 }); // oldest first    res.status(200).json(messages);  } catch (err) {    console.error(err);    res.status(500).json({ message: 'Server error' });  }});module.exports = router;